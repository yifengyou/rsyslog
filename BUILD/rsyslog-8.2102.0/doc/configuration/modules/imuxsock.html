
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>imuxsock: Unix Socket Input Module &#8212; rsyslog 8.2102.0 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/rsyslog.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Parser Modules" href="idx_parser.html" />
    <link rel="prev" title="imudp: UDP Syslog Input Module" href="imudp.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="idx_parser.html" title="Parser Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="imudp.html" title="imudp: UDP Syslog Input Module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">rsyslog 8.2102.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Configuration</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Modules</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="idx_input.html" accesskey="U">Input Modules</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="imuxsock-unix-socket-input-module">
<h1>imuxsock: Unix Socket Input Module<a class="headerlink" href="#imuxsock-unix-socket-input-module" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Module Name:</strong></td>
<td><strong>imuxsock</strong></td>
</tr>
<tr class="row-even"><td><strong>Author:</strong></td>
<td><a class="reference external" href="http://www.gerhards.net/rainer">Rainer Gerhards</a> &lt;<a class="reference external" href="mailto:rgerhards&#37;&#52;&#48;adiscon&#46;com">rgerhards<span>&#64;</span>adiscon<span>&#46;</span>com</a>&gt;</td>
</tr>
</tbody>
</table>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<p>This module provides the ability to accept syslog messages from applications
running on the local system via Unix sockets. Most importantly, this is the
mechanism by which the <em class="manpage">syslog(3)</em> call delivers syslog messages
to rsyslogd.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="omuxsock.html"><span class="doc">omuxsock: Unix sockets Output Module</span></a></p>
</div>
</div>
<div class="section" id="notable-features">
<h2>Notable Features<a class="headerlink" href="#notable-features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#imuxsock-rate-limiting-label"><span class="std std-ref">Input rate limiting</span></a></li>
<li><a class="reference internal" href="#imuxsock-trusted-properties-label"><span class="std std-ref">Trusted (syslog) properties</span></a></li>
<li><a class="reference internal" href="#imuxsock-flow-control-label"><span class="std std-ref">Flow-control of Unix log sockets</span></a></li>
<li><a class="reference internal" href="#imuxsock-application-timestamps-label"><span class="std std-ref">Control over application timestamps</span></a></li>
<li><a class="reference internal" href="#imuxsock-systemd-details-label"><span class="std std-ref">Coexistence with systemd</span></a></li>
</ul>
</div>
<div class="section" id="configuration-parameters">
<h2>Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Parameter names are case-insensitive.</p>
</div>
<div class="section" id="module-parameters">
<h3>Module Parameters<a class="headerlink" href="#module-parameters" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When running under systemd, <strong>many “sysSock.” parameters are ignored</strong>.
See parameter descriptions and the <a class="reference internal" href="#imuxsock-systemd-details-label"><span class="std std-ref">Coexistence with systemd</span></a> section for
details.</p>
</div>
<div class="section" id="syssock-ignoretimestamp">
<h4>SysSock.IgnoreTimestamp<a class="headerlink" href="#syssock-ignoretimestamp" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogSocketIgnoreMsgTimestamp</span></code></td>
</tr>
</tbody>
</table>
<p>Ignore timestamps included in the messages, applies to messages received via
the system log socket.</p>
</div>
<div class="section" id="syssock-ignoreownmessages">
<h4>SysSock.IgnoreOwnMessages<a class="headerlink" href="#syssock-ignoreownmessages" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Ignores messages that originated from the same instance of rsyslogd.
There usually is no reason to receive messages from ourselves. This
setting is vital when writing messages to the systemd journal.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 7.3.7.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See <a class="reference internal" href="omjournal.html"><span class="doc">omjournal</span></a> module documentation for a more
in-depth description.</p>
</div>
</div>
<div class="section" id="syssock-use">
<h4>SysSock.Use<a class="headerlink" href="#syssock-use" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$OmitLocalLogging</span></code></td>
</tr>
</tbody>
</table>
<p>Listen on the default local log socket (<code class="docutils literal notranslate"><span class="pre">/dev/log</span></code>) or, if provided, use
the log socket value assigned to the <code class="docutils literal notranslate"><span class="pre">SysSock.Name</span></code> parameter instead
of the default. This is most useful if you run multiple instances of
rsyslogd where only one shall handle the system log socket.  Unless
disabled by the <code class="docutils literal notranslate"><span class="pre">SysSock.Unlink</span></code> setting, this socket is created
upon rsyslog startup and deleted upon shutdown, according to
traditional syslogd behavior.</p>
<p>The behavior of this parameter is different for systemd systems. For those
systems, <code class="docutils literal notranslate"><span class="pre">SysSock.Use</span></code> still needs to be enabled, but the value of
<code class="docutils literal notranslate"><span class="pre">SysSock.Name</span></code> is ignored and the socket provided by systemd is used
instead. If this parameter is <em>not</em> enabled, then imuxsock will only be
of use if a custom input is configured.</p>
<p>See the <a class="reference internal" href="#imuxsock-systemd-details-label"><span class="std std-ref">Coexistence with systemd</span></a> section for details.</p>
</div>
<div class="section" id="syssock-name">
<h4>SysSock.Name<a class="headerlink" href="#syssock-name" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>word</td>
<td>/dev/log</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogSocketName</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies an alternate log socket to be used instead of the default system
log socket, traditionally <code class="docutils literal notranslate"><span class="pre">/dev/log</span></code>. Unless disabled by the
<code class="docutils literal notranslate"><span class="pre">SysSock.Unlink</span></code> setting, this socket is created upon rsyslog startup
and deleted upon shutdown, according to traditional syslogd behavior.</p>
<dl class="docutils">
<dt>The behavior of this parameter is different for systemd systems. See the</dt>
<dd><a class="reference internal" href="#imuxsock-systemd-details-label"><span class="std std-ref">Coexistence with systemd</span></a> section for details.</dd>
</dl>
</div>
<div class="section" id="syssock-flowcontrol">
<h4>SysSock.FlowControl<a class="headerlink" href="#syssock-flowcontrol" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogFlowControl</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies if flow control should be applied to the system log socket.</p>
</div>
<div class="section" id="syssock-usepidfromsystem">
<h4>SysSock.UsePIDFromSystem<a class="headerlink" href="#syssock-usepidfromsystem" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogUsePIDFromSystem</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies if the pid being logged shall be obtained from the log socket
itself. If so, the TAG part of the message is rewritten. It is recommended
to turn this option on, but the default is “off” to keep compatible
with earlier versions of rsyslog.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.7.0.</span></p>
</div>
</div>
<div class="section" id="syssock-ratelimit-interval">
<h4>SysSock.RateLimit.Interval<a class="headerlink" href="#syssock-ratelimit-interval" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">max</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>0</td>
<td>&#160;</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogRateLimitInterval</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies the rate-limiting interval in seconds. Default value is 0,
which turns off rate limiting. Set it to a number of seconds (5
recommended) to activate rate-limiting. The default of 0 has been
chosen as people experienced problems with this feature activated
by default. Now it needs an explicit opt-in by setting this parameter.</p>
</div>
<div class="section" id="syssock-ratelimit-burst">
<h4>SysSock.RateLimit.Burst<a class="headerlink" href="#syssock-ratelimit-burst" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">max</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>200</td>
<td>(2^31)-1</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogRateLimitBurst</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies the rate-limiting burst in number of messages.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.7.1.</span></p>
</div>
</div>
<div class="section" id="syssock-ratelimit-severity">
<h4>SysSock.RateLimit.Severity<a class="headerlink" href="#syssock-ratelimit-severity" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">max</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>1</td>
<td>&#160;</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogRateLimitSeverity</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies the severity of messages that shall be rate-limited.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://en.wikipedia.org/wiki/Syslog#Severity_level">https://en.wikipedia.org/wiki/Syslog#Severity_level</a></p>
</div>
</div>
<div class="section" id="syssock-usesystimestamp">
<h4>SysSock.UseSysTimeStamp<a class="headerlink" href="#syssock-usesystimestamp" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogUseSysTimeStamp</span></code></td>
</tr>
</tbody>
</table>
<p>The same as the input parameter <code class="docutils literal notranslate"><span class="pre">UseSysTimeStamp</span></code>, but for the system log
socket. This parameter instructs <code class="docutils literal notranslate"><span class="pre">imuxsock</span></code> to obtain message time from
the system (via control messages) instead of using time recorded inside
the message. This may be most useful in combination with systemd. Due to
the usefulness of this functionality, we decided to enable it by default.
As such, the behavior is slightly different than previous versions.
However, we do not see how this could negatively affect existing environments.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.9.1.</span></p>
</div>
</div>
<div class="section" id="syssock-annotate">
<h4>SysSock.Annotate<a class="headerlink" href="#syssock-annotate" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogSocketAnnotate</span></code></td>
</tr>
</tbody>
</table>
<p>Turn on annotation/trusted properties for the system log socket. See
the <a class="reference internal" href="#imuxsock-trusted-properties-label"><span class="std std-ref">Trusted (syslog) properties</span></a> section for more info.</p>
</div>
<div class="section" id="syssock-parsetrusted">
<h4>SysSock.ParseTrusted<a class="headerlink" href="#syssock-parsetrusted" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$SystemLogParseTrusted</span></code></td>
</tr>
</tbody>
</table>
<p>If <code class="docutils literal notranslate"><span class="pre">SysSock.Annotation</span></code> is turned on, create JSON/lumberjack properties
out of the trusted properties (which can be accessed via <code class="docutils literal notranslate"><span class="pre">advanced</span></code>
JSON Variables, e.g. <code class="docutils literal notranslate"><span class="pre">$!pid</span></code>) instead of adding them to the message.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 7.2.7: </span><code class="docutils literal notranslate"><span class="pre">advanced</span></code> directive introduced</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 7.3.8: </span><code class="docutils literal notranslate"><span class="pre">advanced</span></code> directive introduced</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 6.5.0: </span><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive introduced</p>
</div>
</div>
<div class="section" id="syssock-unlink">
<h4>SysSock.Unlink<a class="headerlink" href="#syssock-unlink" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>If turned on (default), the system socket is unlinked and re-created
when opened and also unlinked when finally closed. Note that this
setting has no effect when running under systemd control (because
systemd handles the socket. See the <a class="reference internal" href="#imuxsock-systemd-details-label"><span class="std std-ref">Coexistence with systemd</span></a>
section for details.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 7.3.9.</span></p>
</div>
</div>
<div class="section" id="syssock-usespecialparser">
<h4>SysSock.UseSpecialParser<a class="headerlink" href="#syssock-usespecialparser" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>The equivalent of the <code class="docutils literal notranslate"><span class="pre">UseSpecialParser</span></code> input parameter, but
for the system socket. If turned on (the default) a special parser is
used that parses the format that is usually used
on the system log socket (the one <em class="manpage">syslog(3)</em> creates). If set to
“off”, the regular parser chain is used, in which case the format on the
log socket can be arbitrary.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When the special parser is used, rsyslog is able to inject a more precise
timestamp into the message (it is obtained from the log socket). If the
regular parser chain is used, this is not possible.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.9.0: </span>The setting was previously hard-coded “on”</p>
</div>
</div>
<div class="section" id="syssock-parsehostname">
<h4>SysSock.ParseHostname<a class="headerlink" href="#syssock-parsehostname" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This option only has an effect if <code class="docutils literal notranslate"><span class="pre">SysSock.UseSpecialParser</span></code> is
set to “off”.</p>
</div>
<p>Normally, the local log sockets do <em>not</em> contain hostnames. If set
to on, parsers will expect hostnames just like in regular formats. If
set to off (the default), the parser chain is instructed to not expect
them.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.9.0.</span></p>
</div>
</div>
</div>
<div class="section" id="input-parameters">
<h3>Input Parameters<a class="headerlink" href="#input-parameters" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ruleset">
<h4>Ruleset<a class="headerlink" href="#ruleset" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>default ruleset</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Binds specified ruleset to this input. If not set, the default
ruleset is bound.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.17.0.</span></p>
</div>
</div>
<div class="section" id="ignoretimestamp">
<h4>IgnoreTimestamp<a class="headerlink" href="#ignoretimestamp" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$InputUnixListenSocketIgnoreMsgTimestamp</span></code></td>
</tr>
</tbody>
</table>
<p>Ignore timestamps included in messages received from the input being
defined.</p>
</div>
<div class="section" id="ignoreownmessages">
<h4>IgnoreOwnMessages<a class="headerlink" href="#ignoreownmessages" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Ignore messages that originated from the same instance of rsyslogd.
There usually is no reason to receive messages from ourselves. This
setting is vital when writing messages to the systemd journal.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 7.3.7.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See <a class="reference internal" href="omjournal.html"><span class="doc">omjournal</span></a> module documentation for a more
in-depth description.</p>
</div>
</div>
<div class="section" id="flowcontrol">
<h4>FlowControl<a class="headerlink" href="#flowcontrol" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$InputUnixListenSocketFlowControl</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies if flow control should be applied to the input being defined.</p>
</div>
<div class="section" id="ratelimit-interval">
<h4>RateLimit.Interval<a class="headerlink" href="#ratelimit-interval" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">max</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>0</td>
<td>&#160;</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$IMUXSockRateLimitInterval</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies the rate-limiting interval in seconds. Default value is 0, which
turns off rate limiting. Set it to a number of seconds (5 recommended)
to activate rate-limiting. The default of 0 has been chosen as people
experienced problems with this feature activated by default. Now it
needs an explicit opt-in by setting this parameter.</p>
</div>
<div class="section" id="ratelimit-burst">
<h4>RateLimit.Burst<a class="headerlink" href="#ratelimit-burst" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">max</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>200</td>
<td>(2^31)-1</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$IMUXSockRateLimitBurst</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies the rate-limiting burst in number of messages.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.7.1.</span></p>
</div>
</div>
<div class="section" id="ratelimit-severity">
<h4>RateLimit.Severity<a class="headerlink" href="#ratelimit-severity" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">max</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>1</td>
<td>&#160;</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$IMUXSockRateLimitSeverity</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies the severity of messages that shall be rate-limited.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://en.wikipedia.org/wiki/Syslog#Severity_level">https://en.wikipedia.org/wiki/Syslog#Severity_level</a></p>
</div>
</div>
<div class="section" id="usepidfromsystem">
<h4>UsePIDFromSystem<a class="headerlink" href="#usepidfromsystem" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$InputUnixListenSocketUsePIDFromSystem</span></code></td>
</tr>
</tbody>
</table>
<p>Specifies if the pid being logged shall be obtained from the log socket
itself. If so, the TAG part of the message is rewritten. It is
recommended to turn this option on, but the default is “off” to keep
compatible with earlier versions of rsyslog.</p>
</div>
<div class="section" id="usesystimestamp">
<h4>UseSysTimeStamp<a class="headerlink" href="#usesystimestamp" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$InputUnixListenSocketUseSysTimeStamp</span></code></td>
</tr>
</tbody>
</table>
<p>This parameter instructs <code class="docutils literal notranslate"><span class="pre">imuxsock</span></code> to obtain message time from
the system (via control messages) instead of using time recorded inside
the message. This may be most useful in combination with systemd. Due to
the usefulness of this functionality, we decided to enable it by default.
As such, the behavior is slightly different than previous versions.
However, we do not see how this could negatively affect existing environments.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.9.1.</span></p>
</div>
</div>
<div class="section" id="createpath">
<h4>CreatePath<a class="headerlink" href="#createpath" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$InputUnixListenSocketCreatePath</span></code></td>
</tr>
</tbody>
</table>
<p>Create directories in the socket path if they do not already exist.
They are created with 0755 permissions with the owner being the
process under which rsyslogd runs. The default is not to create
directories. Keep in mind, though, that rsyslogd always creates
the socket itself if it does not exist (just not the directories
by default).</p>
<p>This option is primarily considered useful for defining additional
sockets that reside on non-permanent file systems. As rsyslogd probably
starts up before the daemons that create these sockets, it is a vehicle
to enable rsyslogd to listen to those sockets even though their directories
do not yet exist.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.7.0.</span></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.3.0.</span></p>
</div>
</div>
<div class="section" id="socket">
<h4>Socket<a class="headerlink" href="#socket" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>none</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$AddUnixListenSocket</span></code></td>
</tr>
</tbody>
</table>
<p>Adds additional unix socket. Formerly specified with the <code class="docutils literal notranslate"><span class="pre">-a</span></code> option.</p>
</div>
<div class="section" id="hostname">
<h4>HostName<a class="headerlink" href="#hostname" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>string</td>
<td>NULL</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$InputUnixListenSocketHostName</span></code></td>
</tr>
</tbody>
</table>
<p>Allows overriding the hostname that shall be used inside messages
taken from the input that is being defined.</p>
</div>
<div class="section" id="annotate">
<h4>Annotate<a class="headerlink" href="#annotate" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$InputUnixListenSocketAnnotate</span></code></td>
</tr>
</tbody>
</table>
<p>Turn on annotation/trusted properties for the input that is being defined.
See the <a class="reference internal" href="#imuxsock-trusted-properties-label"><span class="std std-ref">Trusted (syslog) properties</span></a> section for more info.</p>
</div>
<div class="section" id="parsetrusted">
<h4>ParseTrusted<a class="headerlink" href="#parsetrusted" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">$ParseTrusted</span></code></td>
</tr>
</tbody>
</table>
<p>Equivalent to the <code class="docutils literal notranslate"><span class="pre">SysSock.ParseTrusted</span></code> module parameter, but applies
to the input that is being defined.</p>
</div>
<div class="section" id="unlink">
<h4>Unlink<a class="headerlink" href="#unlink" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td><code class="docutils literal notranslate"><span class="pre">none</span></code></td>
</tr>
</tbody>
</table>
<p>If turned on (default), the socket is unlinked and re-created when opened
and also unlinked when finally closed. Set it to off if you handle socket
creation yourself.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that handling socket creation oneself has the
advantage that a limited amount of messages may be queued by the OS
if rsyslog is not running.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 7.3.9.</span></p>
</div>
</div>
<div class="section" id="usespecialparser">
<h4>UseSpecialParser<a class="headerlink" href="#usespecialparser" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>on</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Equivalent to the <code class="docutils literal notranslate"><span class="pre">SysSock.UseSpecialParser</span></code> module parameter, but applies
to the input that is being defined.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.9.0: </span>The setting was previously hard-coded “on”</p>
</div>
</div>
<div class="section" id="parsehostname">
<h4>ParseHostname<a class="headerlink" href="#parsehostname" title="Permalink to this headline">¶</a></h4>
<table border="1" class="colwidths-auto parameter-table docutils">
<thead valign="bottom">
<tr class="row-odd"><th class="head">type</th>
<th class="head">default</th>
<th class="head">mandatory</th>
<th class="head"><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>binary</td>
<td>off</td>
<td>no</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Equivalent to the <code class="docutils literal notranslate"><span class="pre">SysSock.ParseHostname</span></code> module parameter, but applies
to the input that is being defined.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.9.0.</span></p>
</div>
</div>
</div>
</div>
<div class="section" id="input-rate-limiting">
<span id="imuxsock-rate-limiting-label"></span><h2>Input rate limiting<a class="headerlink" href="#input-rate-limiting" title="Permalink to this headline">¶</a></h2>
<p>rsyslog supports (optional) input rate limiting to guard against the problems
of a wild running logging process. If more than
<code class="docutils literal notranslate"><span class="pre">SysSock.RateLimit.Interval</span></code> * <code class="docutils literal notranslate"><span class="pre">SysSock.RateLimit.Burst</span></code> log messages
are emitted from the same process, those messages with
<code class="docutils literal notranslate"><span class="pre">SysSock.RateLimit.Severity</span></code> or lower will be dropped. It is not possible
to recover anything about these messages, but imuxsock will tell you how
many it has dropped once the interval has expired AND the next message is
logged. Rate-limiting depends on <code class="docutils literal notranslate"><span class="pre">SCM\_CREDENTIALS</span></code>. If the platform does
not support this socket option, rate limiting is turned off. If multiple
sockets are configured, rate limiting works independently on each of
them (that should be what you usually expect).</p>
<p>The same functionality is available for additional log sockets, in which
case the config statements just use the prefix RateLimit… but otherwise
works exactly the same. When working with severities, please keep in mind
that higher severity numbers mean lower severity and configure things
accordingly. To turn off rate limiting, set the interval to zero.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.7.1.</span></p>
</div>
</div>
<div class="section" id="trusted-syslog-properties">
<span id="imuxsock-trusted-properties-label"></span><h2>Trusted (syslog) properties<a class="headerlink" href="#trusted-syslog-properties" title="Permalink to this headline">¶</a></h2>
<p>rsyslog can annotate messages from system log sockets (via imuxsock) with
so-called <a class="reference external" href="http://www.rsyslog.com/what-are-trusted-properties/">Trusted syslog
properties</a>, (or just
“Trusted Properties” for short). These are message properties not provided by
the logging client application itself, but rather obtained from the system.
As such, they can not be faked by the user application and are trusted in
this sense. This feature is based on a similar idea introduced in systemd.</p>
<p>This feature requires a recent enough Linux Kernel and access to
the <code class="docutils literal notranslate"><span class="pre">/proc</span></code> file system. In other words, this may not work on all
platforms and may not work fully when privileges are dropped (depending
on how they are dropped). Note that trusted properties can be very
useful, but also typically cause the message to grow rather large. Also,
the format of log messages is changed by adding the trusted properties at
the end. For these reasons, the feature is <strong>not enabled by default</strong>.
If you want to use it, you must turn it on (via
<code class="docutils literal notranslate"><span class="pre">SysSock.Annotate</span></code> and <code class="docutils literal notranslate"><span class="pre">Annotate</span></code>).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 5.9.4.</span></p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="http://www.rsyslog.com/what-are-trusted-properties/">What are “trusted properties”?</a></p>
</div>
</div>
<div class="section" id="flow-control-of-unix-log-sockets">
<span id="imuxsock-flow-control-label"></span><h2>Flow-control of Unix log sockets<a class="headerlink" href="#flow-control-of-unix-log-sockets" title="Permalink to this headline">¶</a></h2>
<p>If processing queues fill up, the unix socket reader is blocked for a
short while to help prevent overrunning the queues. If the queues are
overrun, this may cause excessive disk-io and impact performance.</p>
<p>While turning on flow control for many systems does not hurt, it <cite>can</cite> lead
to a very unresponsive system and as such is disabled by default.</p>
<p>This means that log records are placed as quickly as possible into the
processing queues. If you would like to have flow control, you
need to enable it via the <code class="docutils literal notranslate"><span class="pre">SysSock.FlowControl</span></code> and <code class="docutils literal notranslate"><span class="pre">FlowControl</span></code> config
directives. Just make sure you have thought about the implications and have
tested the change on a non-production system first.</p>
</div>
<div class="section" id="control-over-application-timestamps">
<span id="imuxsock-application-timestamps-label"></span><h2>Control over application timestamps<a class="headerlink" href="#control-over-application-timestamps" title="Permalink to this headline">¶</a></h2>
<p>Application timestamps are ignored by default. This is needed, as some
programs (e.g. sshd) log with inconsistent timezone information, what
messes up the local logs (which by default don’t even contain time zone
information). This seems to be consistent with what sysklogd has done for
many years. Alternate behaviour may be desirable if gateway-like processes
send messages via the local log slot. In that case, it can be enabled via
the <code class="docutils literal notranslate"><span class="pre">SysSock.IgnoreTimestamp</span></code> and <code class="docutils literal notranslate"><span class="pre">IgnoreTimestamp</span></code> config directives.</p>
</div>
<div class="section" id="coexistence-with-systemd">
<span id="imuxsock-systemd-details-label"></span><h2>Coexistence with systemd<a class="headerlink" href="#coexistence-with-systemd" title="Permalink to this headline">¶</a></h2>
<p>Rsyslog should by default be configured for systemd support on all platforms
that usually run systemd (which means most Linux distributions, but not, for
example, Solaris).</p>
<p>Rsyslog is able to coexist with systemd with minimal changes on the part of the
local system administrator. While the <code class="docutils literal notranslate"><span class="pre">systemd</span> <span class="pre">journal</span></code> now assumes full
control of the local <code class="docutils literal notranslate"><span class="pre">/dev/log</span></code> system log socket, systemd provides
access to logging data via the <code class="docutils literal notranslate"><span class="pre">/run/systemd/journal/syslog</span></code> log socket.
This log socket is provided by the <code class="docutils literal notranslate"><span class="pre">syslog.socket</span></code> file that is shipped
with systemd.</p>
<p>The imuxsock module can still be used in this setup and provides superior
performance over <a class="reference internal" href="imjournal.html"><span class="doc">imjournal</span></a>, the alternative journal input
module.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It must be noted, however, that the journal tends to drop messages
when it becomes busy instead of forwarding them to the system log socket.
This is because the journal uses an async log socket interface for forwarding
instead of the traditional synchronous one.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 8.32.0: </span>rsyslog emits an informational message noting the system log socket provided
by systemd.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="imjournal.html"><span class="doc">imjournal: Systemd Journal Input Module</span></a></p>
</div>
<div class="section" id="handling-of-sockets">
<h3>Handling of sockets<a class="headerlink" href="#handling-of-sockets" title="Permalink to this headline">¶</a></h3>
<p>What follows is a brief description of the process rsyslog takes to determine
what system socket to use, which sockets rsyslog should listen on, whether
the sockets should be created and how rsyslog should handle the sockets when
shutting down.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://www.freedesktop.org/wiki/Software/systemd/syslog/">Writing syslog Daemons Which Cooperate Nicely With systemd</a></p>
</div>
<div class="section" id="step-1-select-name-of-system-socket">
<h4>Step 1: Select name of system socket<a class="headerlink" href="#step-1-select-name-of-system-socket" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>If the user has not explicitly chosen to set <code class="docutils literal notranslate"><span class="pre">SysSock.Use=&quot;off&quot;</span></code> then
the default listener socket (aka, “system log socket” or simply “system
socket”) name is set to <code class="docutils literal notranslate"><span class="pre">/dev/log</span></code>. Otherwise, if the user <cite>has</cite>
explicitly set <code class="docutils literal notranslate"><span class="pre">SysSock.Use=&quot;off&quot;</span></code>, then rsyslog will not listen on
<code class="docutils literal notranslate"><span class="pre">/dev/log</span></code> OR any socket defined by the <code class="docutils literal notranslate"><span class="pre">SysSock.Name</span></code> parameter and
the rest of this section does not apply.</li>
<li>If the user has specified <code class="docutils literal notranslate"><span class="pre">sysSock.Name=&quot;/path/to/custom/socket&quot;</span></code> (and not
explicitly set <code class="docutils literal notranslate"><span class="pre">SysSock.Use=&quot;off&quot;</span></code>), then the default listener socket name
is overwritten with <code class="docutils literal notranslate"><span class="pre">/path/to/custom/socket</span></code>.</li>
<li>Otherwise, if rsyslog is running under systemd AND
<code class="docutils literal notranslate"><span class="pre">/run/systemd/journal/syslog</span></code> exists, (AND the user has not
explicitly set <code class="docutils literal notranslate"><span class="pre">SysSock.Use=&quot;off&quot;</span></code>) then the default listener socket name
is overwritten with <code class="docutils literal notranslate"><span class="pre">/run/systemd/journal/syslog</span></code>.</li>
</ol>
</div>
<div class="section" id="step-2-listen-on-specified-sockets">
<h4>Step 2: Listen on specified sockets<a class="headerlink" href="#step-2-listen-on-specified-sockets" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is true for all sockets, be it system socket or not. But if
<code class="docutils literal notranslate"><span class="pre">SysSock.Use=&quot;off&quot;</span></code>, the system socket will not be listened on.</p>
</div>
<p>rsyslog evaluates the list of sockets it has been asked to activate:</p>
<ul class="simple">
<li>the system log socket (if still enabled after completion of the last section)</li>
<li>any custom inputs defined by the user</li>
</ul>
<p>and then checks to see if it has been passed in via systemd (name is checked).
If it was passed in via systemd, the socket is used as-is (e.g., not recreated
upon rsyslog startup), otherwise if not passed in via systemd the log socket
is unlinked, created and opened.</p>
</div>
<div class="section" id="step-3-shutdown-log-sockets">
<h4>Step 3: Shutdown log sockets<a class="headerlink" href="#step-3-shutdown-log-sockets" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is true for all sockets, be it system socket or not.</p>
</div>
<p>Upon shutdown, rsyslog processes each socket it is listening on and evaluates
it. If the socket was originally passed in via systemd (name is checked), then
rsyslog does nothing with the socket (systemd maintains the socket).</p>
<p>If the socket was <cite>not</cite> passed in via systemd AND the configuration permits
rsyslog to do so (the default setting), rsyslog will unlink/remove the log
socket. If not permitted to do so (the user specified otherwise), then rsyslog
will not unlink the log socket and will leave that cleanup step to the
user or application that created the socket to remove it.</p>
</div>
</div>
</div>
<div class="section" id="statistic-counter">
<h2>Statistic Counter<a class="headerlink" href="#statistic-counter" title="Permalink to this headline">¶</a></h2>
<p>This plugin maintains a global <a class="reference internal" href="../rsyslog_statistic_counter.html"><span class="doc">statistics</span></a> with the following properties:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">submitted</span></code> - total number of messages submitted for processing since startup</li>
<li><code class="docutils literal notranslate"><span class="pre">ratelimit.discarded</span></code> - number of messages discarded due to rate limiting</li>
<li><code class="docutils literal notranslate"><span class="pre">ratelimit.numratelimiters</span></code> - number of currently active rate limiters
(small data structures used for the rate limiting logic)</li>
</ul>
</div>
<div class="section" id="caveats-known-bugs">
<h2>Caveats/Known Bugs<a class="headerlink" href="#caveats-known-bugs" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>When running under systemd, <strong>many “sysSock.” parameters are ignored</strong>.
See parameter descriptions and the <a class="reference internal" href="#imuxsock-systemd-details-label"><span class="std std-ref">Coexistence with systemd</span></a> section for
details.</li>
<li>On systems where systemd is used this module is often not loaded by default.
See the <a class="reference internal" href="#imuxsock-systemd-details-label"><span class="std std-ref">Coexistence with systemd</span></a> section for details.</li>
<li>Application timestamps are ignored by default. See the
<a class="reference internal" href="#imuxsock-application-timestamps-label"><span class="std std-ref">Control over application timestamps</span></a> section for details.</li>
<li><a class="reference external" href="http://www.rsyslog.com/why-does-imuxsock-not-work-on-solaris/">imuxsock does not work on Solaris</a></li>
</ul>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="minimum-setup">
<h3>Minimum setup<a class="headerlink" href="#minimum-setup" title="Permalink to this headline">¶</a></h3>
<p>The following sample is the minimum setup required to accept syslog
messages from applications running on the local system.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imuxsock&quot;)
</pre></div>
</div>
<p>This only needs to be done once.</p>
</div>
<div class="section" id="enable-flow-control">
<h3>Enable flow control<a class="headerlink" href="#enable-flow-control" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> module(load=&quot;imuxsock&quot; # needs to be done just once
<span class="hll">        SysSock.FlowControl=&quot;on&quot;) # enable flow control (use if needed)
</span></pre></div>
</div>
</div>
<div class="section" id="enable-trusted-properties">
<h3>Enable trusted properties<a class="headerlink" href="#enable-trusted-properties" title="Permalink to this headline">¶</a></h3>
<p>As noted in the <a class="reference internal" href="#imuxsock-trusted-properties-label"><span class="std std-ref">Trusted (syslog) properties</span></a> section, trusted properties
are disabled by default. If you want to use them, you must turn the feature
on via <code class="docutils literal notranslate"><span class="pre">SysSock.Annotate</span></code> for the system log socket and <code class="docutils literal notranslate"><span class="pre">Annotate</span></code> for
inputs.</p>
<div class="section" id="append-to-end-of-message">
<h4>Append to end of message<a class="headerlink" href="#append-to-end-of-message" title="Permalink to this headline">¶</a></h4>
<p>The following sample is used to activate message annotation and thus
trusted properties on the system log socket. These trusted properties
are appended to the end of each message.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imuxsock&quot; # needs to be done just once
<span class="hll">         SysSock.Annotate=&quot;on&quot;)
</span></pre></div>
</div>
</div>
<div class="section" id="store-in-json-message-properties">
<h4>Store in JSON message properties<a class="headerlink" href="#store-in-json-message-properties" title="Permalink to this headline">¶</a></h4>
<p>The following sample is similar to the first one, but enables parsing of
trusted properties, which places the results into JSON/lumberjack variables.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imuxsock&quot;
<span class="hll">         SysSock.Annotate=&quot;on&quot; SysSock.ParseTrusted=&quot;on&quot;)
</span></pre></div>
</div>
</div>
</div>
<div class="section" id="read-log-data-from-jails">
<h3>Read log data from jails<a class="headerlink" href="#read-log-data-from-jails" title="Permalink to this headline">¶</a></h3>
<p>The following sample is a configuration where rsyslogd pulls logs from
two jails, and assigns different hostnames to each of the jails:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imuxsock&quot;) # needs to be done just once
input(type=&quot;imuxsock&quot;
<span class="hll">      HostName=&quot;jail1.example.net&quot;
</span><span class="hll">      Socket=&quot;/jail/1/dev/log&quot;) input(type=&quot;imuxsock&quot;
</span><span class="hll">      HostName=&quot;jail2.example.net&quot; Socket=&quot;/jail/2/dev/log&quot;)
</span></pre></div>
</div>
</div>
<div class="section" id="read-from-socket-on-temporary-file-system">
<h3>Read from socket on temporary file system<a class="headerlink" href="#read-from-socket-on-temporary-file-system" title="Permalink to this headline">¶</a></h3>
<p>The following sample is a configuration where rsyslogd reads the openssh
log messages via a separate socket, but this socket is created on a
temporary file system. As rsyslogd starts up before the sshd daemon, it needs
to create the socket directories, because it otherwise can not open the
socket and thus not listen to openssh messages.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imuxsock&quot;) # needs to be done just once
input(type=&quot;imuxsock&quot;
<span class="hll">      Socket=&quot;/var/run/sshd/dev/log&quot;
</span><span class="hll">      CreatePath=&quot;on&quot;)
</span></pre></div>
</div>
</div>
<div class="section" id="disable-rate-limiting">
<h3>Disable rate limiting<a class="headerlink" href="#disable-rate-limiting" title="Permalink to this headline">¶</a></h3>
<p>The following sample is used to turn off input rate limiting on the
system log socket.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imuxsock&quot; # needs to be done just once
<span class="hll">         SysSock.RateLimit.Interval=&quot;0&quot;) # turn off rate limiting
</span></pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Help with configuring/using <code class="docutils literal notranslate"><span class="pre">Rsyslog</span></code>:</p>
<ul class="last simple">
<li><a class="reference external" href="http://lists.adiscon.net/mailman/listinfo/rsyslog">Mailing list</a> - best route for general questions</li>
<li>GitHub: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a> - detailed questions, reporting issues
that are believed to be bugs with <code class="docutils literal notranslate"><span class="pre">Rsyslog</span></code></li>
<li>Stack Exchange (<a class="reference external" href="https://stackexchange.com/filters/327462/rsyslog">View</a>, <a class="reference external" href="https://serverfault.com/questions/ask?tags=rsyslog">Ask</a>)
- experimental support from rsyslog community</li>
</ul>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p>Contributing to <code class="docutils literal notranslate"><span class="pre">Rsyslog</span></code>:</p>
<ul class="last simple">
<li>Source project: <a class="reference external" href="https://github.com/rsyslog/rsyslog/blob/master/README.md">rsyslog project README</a>.</li>
<li>Documentation: <a class="reference external" href="https://github.com/rsyslog/rsyslog-doc/blob/master/README.md">rsyslog-doc project README</a></li>
</ul>
</div>
<p>Copyright 2008-2020 <a class="reference external" href="https://rainer.gerhards.net/">Rainer Gerhards</a>
(<a class="reference external" href="https://www.rainer-gerhards.de/grossrinderfeld/">Großrinderfeld</a>),
and Others.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">imuxsock: Unix Socket Input Module</a><ul>
<li><a class="reference internal" href="#purpose">Purpose</a></li>
<li><a class="reference internal" href="#notable-features">Notable Features</a></li>
<li><a class="reference internal" href="#configuration-parameters">Configuration Parameters</a><ul>
<li><a class="reference internal" href="#module-parameters">Module Parameters</a><ul>
<li><a class="reference internal" href="#syssock-ignoretimestamp">SysSock.IgnoreTimestamp</a></li>
<li><a class="reference internal" href="#syssock-ignoreownmessages">SysSock.IgnoreOwnMessages</a></li>
<li><a class="reference internal" href="#syssock-use">SysSock.Use</a></li>
<li><a class="reference internal" href="#syssock-name">SysSock.Name</a></li>
<li><a class="reference internal" href="#syssock-flowcontrol">SysSock.FlowControl</a></li>
<li><a class="reference internal" href="#syssock-usepidfromsystem">SysSock.UsePIDFromSystem</a></li>
<li><a class="reference internal" href="#syssock-ratelimit-interval">SysSock.RateLimit.Interval</a></li>
<li><a class="reference internal" href="#syssock-ratelimit-burst">SysSock.RateLimit.Burst</a></li>
<li><a class="reference internal" href="#syssock-ratelimit-severity">SysSock.RateLimit.Severity</a></li>
<li><a class="reference internal" href="#syssock-usesystimestamp">SysSock.UseSysTimeStamp</a></li>
<li><a class="reference internal" href="#syssock-annotate">SysSock.Annotate</a></li>
<li><a class="reference internal" href="#syssock-parsetrusted">SysSock.ParseTrusted</a></li>
<li><a class="reference internal" href="#syssock-unlink">SysSock.Unlink</a></li>
<li><a class="reference internal" href="#syssock-usespecialparser">SysSock.UseSpecialParser</a></li>
<li><a class="reference internal" href="#syssock-parsehostname">SysSock.ParseHostname</a></li>
</ul>
</li>
<li><a class="reference internal" href="#input-parameters">Input Parameters</a><ul>
<li><a class="reference internal" href="#ruleset">Ruleset</a></li>
<li><a class="reference internal" href="#ignoretimestamp">IgnoreTimestamp</a></li>
<li><a class="reference internal" href="#ignoreownmessages">IgnoreOwnMessages</a></li>
<li><a class="reference internal" href="#flowcontrol">FlowControl</a></li>
<li><a class="reference internal" href="#ratelimit-interval">RateLimit.Interval</a></li>
<li><a class="reference internal" href="#ratelimit-burst">RateLimit.Burst</a></li>
<li><a class="reference internal" href="#ratelimit-severity">RateLimit.Severity</a></li>
<li><a class="reference internal" href="#usepidfromsystem">UsePIDFromSystem</a></li>
<li><a class="reference internal" href="#usesystimestamp">UseSysTimeStamp</a></li>
<li><a class="reference internal" href="#createpath">CreatePath</a></li>
<li><a class="reference internal" href="#socket">Socket</a></li>
<li><a class="reference internal" href="#hostname">HostName</a></li>
<li><a class="reference internal" href="#annotate">Annotate</a></li>
<li><a class="reference internal" href="#parsetrusted">ParseTrusted</a></li>
<li><a class="reference internal" href="#unlink">Unlink</a></li>
<li><a class="reference internal" href="#usespecialparser">UseSpecialParser</a></li>
<li><a class="reference internal" href="#parsehostname">ParseHostname</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#input-rate-limiting">Input rate limiting</a></li>
<li><a class="reference internal" href="#trusted-syslog-properties">Trusted (syslog) properties</a></li>
<li><a class="reference internal" href="#flow-control-of-unix-log-sockets">Flow-control of Unix log sockets</a></li>
<li><a class="reference internal" href="#control-over-application-timestamps">Control over application timestamps</a></li>
<li><a class="reference internal" href="#coexistence-with-systemd">Coexistence with systemd</a><ul>
<li><a class="reference internal" href="#handling-of-sockets">Handling of sockets</a><ul>
<li><a class="reference internal" href="#step-1-select-name-of-system-socket">Step 1: Select name of system socket</a></li>
<li><a class="reference internal" href="#step-2-listen-on-specified-sockets">Step 2: Listen on specified sockets</a></li>
<li><a class="reference internal" href="#step-3-shutdown-log-sockets">Step 3: Shutdown log sockets</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#statistic-counter">Statistic Counter</a></li>
<li><a class="reference internal" href="#caveats-known-bugs">Caveats/Known Bugs</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#minimum-setup">Minimum setup</a></li>
<li><a class="reference internal" href="#enable-flow-control">Enable flow control</a></li>
<li><a class="reference internal" href="#enable-trusted-properties">Enable trusted properties</a><ul>
<li><a class="reference internal" href="#append-to-end-of-message">Append to end of message</a></li>
<li><a class="reference internal" href="#store-in-json-message-properties">Store in JSON message properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#read-log-data-from-jails">Read log data from jails</a></li>
<li><a class="reference internal" href="#read-from-socket-on-temporary-file-system">Read from socket on temporary file system</a></li>
<li><a class="reference internal" href="#disable-rate-limiting">Disable rate limiting</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="imudp.html"
                        title="previous chapter">imudp: UDP Syslog Input Module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="idx_parser.html"
                        title="next chapter">Parser Modules</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/configuration/modules/imuxsock.rst.txt"
           rel="nofollow">Show Source</a></li>
    <li><a href="https://github.com/rsyslog/rsyslog-doc/edit/master/source/configuration/modules/imuxsock.rst"
           rel="nofollow">Edit on GitHub</a></li>
  </ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="idx_parser.html" title="Parser Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="imudp.html" title="imudp: UDP Syslog Input Module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">rsyslog 8.2102.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Configuration</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Modules</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="idx_input.html" >Input Modules</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>